pipeline{
    agent any
    stages {
	    stage('Checking php version') {
            steps {
        	sh 'echo "Test of dit werkt"'
            }
        }
        
        stage('SonarQube Analysis'){
            steps{
                script{
                    def scannerHome = tool 'SonarQube Scanner 2.16.1';
                }
                withSonarQubeENv('SonarQube'){
                    sh "${scannerHome}/bin/sonar-scanner"
                }
            }
        }
         stage("SonarQube Quality Gate Check") {
            steps {
                script {
                def qualityGate = waitForQualityGate()
                    
                    if (qualityGate.status != 'OK') {
                        echo "${qualityGate.status}"
                        error "Quality Gate failed: ${qualityGateStatus}"
                    }
                    else {
                        echo "${qualityGate.status}"
                        echo "SonarQube Quality Gates Passed"
                    }
                }
            }
        }
    }
}